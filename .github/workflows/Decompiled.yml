name: Decompile all RPYC to RPYüëªüíÄ‚ò†Ô∏è

on:
  push:
    paths:
      - 'to_rpy/**/*.rpyc'
      - '.github/workflows/decompile_rpyc.yml'

jobs:
  decompile:
    runs-on: ubuntu-latest
    steps:
      - name: Checkout repo
        uses: actions/checkout@v4

      - name: Setup Python
        uses: actions/setup-python@v4
        with:
          python-version: '3.10'
      
      - name: Install unrpyc
        run: pip install unrpyc

      - name: Create output folder
        run: mkdir -p to_rpy_decompiled

      - name: Decompile all .rpyc in to_rpy
        run: |
          find to_rpy -name "*.rpyc" | while read file; do
            echo "Dekompilasi $file..."
            unrpyc "$file" --output "to_rpy_decompiled/$(basename "$file" .rpyc).rpy"
          done
      
      - name: List output files
        run: |
          echo "Hasil decompile:"
          ls -l to_rpy_decompiled/
